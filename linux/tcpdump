https://www.cnblogs.com/f-ck-need-u/p/7064286.html

 对于 Linux: 你 必须 是 root, 或者 把它 安装成 root 的 设置uid 程序.
 
不带任何选项的tcpdump，默认会抓取第一个网络接口，且只有将tcpdump进程终止才会停止抓包

-c：指定要抓取的包数量。注意，是最终要获取这么多个包。例如，指定"-c 10"将获取10个包，但可能已经处理了100个包，只不过只有10个包是满足条件的包。
-i interface：指定tcpdump需要监听的接口。若未指定该选项，将从系统接口列表中搜寻编号最小的已配置好的接口(不包括loopback接口，
              要抓取loopback接口使用tcpdump -i lo)，
            ：一旦找到第一个符合条件的接口，搜寻马上结束。可以使用'any'关键字表示所有网络接口。
-n：对地址以数字方式显式，否则显式为主机名，也就是说-n选项不做主机名解析。
-nn：除了-n的作用外，还把端口显示为数值，否则显示端口服务名。

输出选项：
-e：输出的每行中都将包括数据链路层头部信息，例如源MAC和目标MAC。
-q：快速打印输出。即打印很少的协议相关信息，从而输出行都比较简短。
-X：输出包的头部数据，会以16进制和ASCII两种方式同时输出。
-XX：输出包的头部数据，会以16进制和ASCII两种方式同时输出，更详细。
-v：当分析和打印的时候，产生详细的输出。
-vv：产生比-v更详细的输出。
-vvv：产生比-vv更详细的输出。

其他功能性选项：
-D：列出可用于抓包的接口。将会列出接口的数值编号和接口名，它们都可以用于"-i"后。
-F：从文件中读取抓包的表达式。若使用该选项，则命令行中给定的其他表达式都将失效。
-w：将抓包数据输出到文件中而不是标准输出。可以同时配合"-G time"选项使得输出文件每time秒就自动切换到另一个文件。
可通过"-r"选项载入这些文件以进行分析和打印。
-r：从给定的数据包文件中读取数据。使用"-"表示从标准输入中读取。

1.显示本地所有可以抓包的接口
tcpdump -D

2.监视指定网络接口的数据包
tcpdump -i ens33

3.监视指定主机的数据包，例如所有进入或离开longshuai的数据包
tcpdump host longshuai

4.截获主机hostname发送的所有数据
tcpdump src host hostname

5.监视所有发送到主机hostname的数据包
tcpdump dst host hostname

6.监视指定主机和端口的数据包
tcpdump tcp port 22 and host hostname

7.对本机的udp 123端口进行监视(123为ntp的服务端口)
tcpdump udp port 123

8.监视指定网络的数据包，如本机与192.168网段通信的数据包，"-c 10"表示只抓取10个包
tcpdump -c 10 net 192.168

9.抓取ping包
tcpdump -c 5 -nn -i eth0 icmp 

如果明确要抓取主机为192.168.100.70对本机的ping，则使用and操作符。
tcpdump -c 5 -nn -i eth0 icmp and src 192.168.100.62

10.抓取到本机22端口包
tcpdump -c 10 -nn -i eth0 tcp dst port 22  
