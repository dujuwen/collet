https://helei112g.github.io/2017/08/25/Web%E5%BC%80%E5%8F%91%E4%B8%AD%E8%AF%B4%E9%AB%98%E5%B9%B6%E5%8F%91%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%88%91%E4%BB%AC%E5%9C%A8%E8%AF%B4%E4%BB%80%E4%B9%88/

http://www.nxops.cn/post/76.html

1、网络

带宽
一个需要支持 1 万并发且平均页面内容在 100KB 的情况下，就需要大概 1G 的带宽，如果带宽只有 100M，需要支持这样的场景无论如何也是不可能的。
更好的带宽可以支持更高的并发

路由
现在的 IDC 运营商有很多，越小的运营商在路由优化上就不怎么样，例如在对 IDC 进行测试的时候，大部分运维使用 ping 来测试机房的网络质量，
这种测试其实是点到点的测试，中间大网的情况就测试不到。在使用 mtr 进行测试的时候，可以看到每一跳的延迟及路由，很多时候会发现浮动路由。
这种情况下网络质量一定不好。最好通过 mtr 对机房提供的 IP 连续进行一周的测试，路径都比较稳定的时候这样的机房值得选择。

2、硬件

CPU
一般情况下作为 Tengine/Nginx 的应用，CPU 的频率我认为对性能影响还是较小的，但是核心数对于 Tengine/Nginx 而言确实很有用，更多的核心数外加 HT 技术，
可以让 Tengine/Nginx 运行更多的 worker，从而提升 Tengine/Nginx 的负载能力

内存
内存的容量直接对 Tengine/Nginx 可承载的连接数有影响（主要指 ESTAB 连接）。另外大容量的内存在结合 tmpfs 进行合理使用的话，
可以作为 Tengine/Nginx 的各种 temp 目录及各种缓存目录，降低对磁盘 IO 的消耗

网卡
目前在互联网公司 DELL 的服务器应该是用的最多的了，而且在用户没有特殊需求的时候，配置的网卡通常是 Broadcom BCM57XX 的，
这种网卡比较便宜所有在处理小包的时候，带宽利用率不高，且流量大的时候会出现大量丢包。在 Tengine/Nginx 的机器上还是推荐使用 Intel X350I QP 的网卡，在使用最新的网卡驱动后，可以对网卡做出更多性能控制（X350 默认的 RSS 队列最大为 8 个）

磁盘
磁盘的 IO 能力个人认为在硬件里的比重不高，在拿 Tengine/Nginx 作为专用缓存服务器的时候，使用 SATA SSD 或者 PCIe-SSD 卡时可以作为缓存存放的目录路径。
一般 Intel S3710 800G 的大概 7000 左右，同容量宝存的 800G PCIe-SSD 大约 1.5W。

3、系统

TCP/IP 协议栈
CLOSE_WAIT 与 TIME_WAIT
这两种连接状态是 Web 服务器中大家最关心的也是最让大家头疼的，虽然很多的博客里说现在服务器内存大，这种连接达到几万、
几十万时对内存的消耗不是问题不用去理会，但是在一些场景中可能会对应用造成很大的影响。例如在我们的业务中出现 CLOSE-WAIT 状态时，
是数据库有长事务执行时导致 Resin 出现了 CLOSE-WAIT 连接，当这种连接数高于 10 个时，应用就会打开慢直到应用打不开。所以需要对其进行优化。
尽量避免系统中出现过多的这两种连接。
